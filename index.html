<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SafeLife</title>
</head>
<body style="background-image: url('/bg.png'); background-repeat: no-repeat; background-size: cover;">
    <center><div><h1 style="color: black">Safe</h1><h1 style="color: light-blue;">Life</h1></div></center>
    <center><div><input id="smashanpass" />
    <button onclick="getData()">Proxy</button></div>
    <div id="output"></div>
    <div><input id="sigmaskibididontquestionit" /><button onclick="setserver()">Change SafeLife Hub</button><p id="ineedtoshit">Status: ðŸŸ¡</p></div></center>

    <script>
        var lastRemadeURL = '';
        var url = null;
        var proxyserverd = 'https://safelifehub.hamperhamps.space/';
        function setserver() {
            var inputElement = document.getElementById('sigmaskibididontquestionit');
            proxyserverd = inputElement.value.trim();
        }
            
        // Function to fetch content using proxy
        function fetchData(url) {
            lastRemadeURL = url;
            fetch(proxyserverd + `?url=${encodeURIComponent(url)}`)
                .then(response => response.json())
                .then(data => {
                    if (data.content) {
                        document.open();
                        document.write(data.content);
                        document.close();
                        // Perform additional actions if needed
                    } else {
                        document.getElementById('output').innerHTML = '<p style="color: red;">The site does not exist or could not be fetched.</p>';
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    document.getElementById('output').innerHTML = '<p style="color: red;">Womp Womp. Your SafeLife Hub is down/broken</p>';
                });
        }

        // Function to handle form submission
        function getData() {
            var inputElement = document.getElementById('smashanpass');
            url = inputElement.value.trim(); // Trim whitespace
            
            if (url) {
                fetchData(url);
            } else {
                document.getElementById('output').innerHTML = '<p style="color: red;">Please enter a valid URL.</p>';
            }
        }

        // Function to check for new links every second
        // Function to check for new links every second
        // Function to check for new links every second
// Define a global variable to store the last remade URL
        

        // Function to check for new links every second
        setInterval(function() {
            var links = document.getElementsByTagName('a');
            for (var i = 0; i < links.length; i++) {
                if (!links[i].hasAttribute('data-handled')) {
                    links[i].setAttribute('data-handled', true); // Mark link as handled
                    links[i].addEventListener('click', function(event) {
                        event.preventDefault(); // Prevent the default link behavior
                        var urlsd = this.href;
                        if (urlsd.includes("http")) {
                            console.log("u good bro");
                            console.log(lastRemadeURL);
                        }
                        else {
                            let currentUrl = window.location.href;
                            console.log(currentUrl);
                            // Construct full URL using base URL and last part of href
                            urlsd = lastRemadeURL + urlsd;
                            urlsd = urlsd + '/';
                            urlsd.replace(currentUrl, "");
                             // Store the last remade URL in the global variable
                            console.log("Attemptus petronum");
                            console.log(urlsd);
                        }
                        fetchData(urlsd); // Fetch content using proxy
                    });
                }
            }
        }, 1000); // Check every second (1000 milliseconds)
        async function checkWebsiteStatus() {
            try {
                const response = await fetch(proxyserverd + 'ping');
                if (response.ok) {
                    document.getElementById('ineedtoshit').textContent = 'Status: ðŸŸ¢';
                } else {
                    document.getElementById('ineedtoshit').textContent = 'Status: ðŸ”´';
                }
            } catch (error) {
                document.getElementById('ineedtoshit').textContent = 'Status: ðŸ”´';
                console.error('Error:', error);
            }
        }

        // Check website status every 5 seconds (adjust as needed)
        setInterval(checkWebsiteStatus, 1000);
                    



    </script>
</body>
</html>
